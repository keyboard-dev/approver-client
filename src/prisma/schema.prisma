// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  // Default path - can be overridden programmatically in DatabaseService
  url      = "file:./data.db"
}

model Message {
  id                String   @id
  title             String
  body              String
  timestamp         BigInt
  priority          String?  // 'low' | 'normal' | 'high' | 'urgent'
  sender            String?
  read              Boolean  @default(false)
  status            String?  // 'pending' | 'approved' | 'rejected'
  feedback          String?
  requiresResponse  Boolean  @default(false)
  codeEval          Boolean  @default(false)
  code              String?
  explanation       String?
  type              String?
  risk_level        String?  // 'low' | 'medium' | 'high'
  codespaceResponse String?  // JSON string
  createdAt         DateTime @default(now())
  updatedAt         DateTime @updatedAt

  // Indexes for faster lookups
  // Separate indexes since queries either sort by timestamp OR filter by status, never both
  @@index([timestamp(sort: Desc)], name: "idx_message_timestamp")
  @@index([status], name: "idx_message_status")
}

model ShareMessage {
  id                 String   @id
  type               String   @default("collection-share")
  title              String
  body               String
  timestamp          BigInt
  priority           String?  // 'low' | 'normal' | 'high' | 'urgent'
  sender             String?
  read               Boolean  @default(false)
  status             String?  // 'pending' | 'approved' | 'rejected'
  requiresResponse   Boolean  @default(false)
  collectionRequest  String   // JSON string for CollectionRequest
  createdAt          DateTime @default(now())
  updatedAt          DateTime @updatedAt

  // Indexes for faster lookups
  // Separate indexes since queries either sort by timestamp OR filter by status, never both
  @@index([timestamp(sort: Desc)], name: "idx_share_message_timestamp")
  @@index([status], name: "idx_share_message_status")
}
